{
    "openapi": "3.0.3",
    "info": {
        "title": "Cart Management Events API",
        "description": "This OpenAPI specification defines the data schemas for events related to cart management, specifically the 'Added to Cart' event. These schemas are used for validating the structure of event payloads that are published to Kafka topics when customers interact with their shopping carts. The events capture details about the cart, line items, pricing, and customer information to enable downstream processing and analytics.",
        "version": "1.0.0"
    },
    "components": {
        "schemas": {
            "Price": {
                "type": "object",
                "description": "Price information",
                "properties": {
                    "orgId": {
                        "type": "string",
                        "description": "Identifier of the organization/tenant"
                    },
                    "amount": {
                        "type": "number",
                        "description": "The numeric value of the price"
                    },
                    "currency": {
                        "type": "string",
                        "default": "USD",
                        "description": "The currency code (e.g., USD)"
                    }
                },
                "required": [
                    "orgId",
                    "amount",
                    "currency"
                ]
            },
            "OrderLineItem": {
                "type": "object",
                "description": "Individual line item in an order",
                "properties": {
                    "orgId": {
                        "type": "string",
                        "description": "Identifier of the organization/tenant"
                    },
                    "itemId": {
                        "type": "string",
                        "description": "A unique identifier for this line item"
                    },
                    "productType": {
                        "type": "string",
                        "enum": [
                            "Data",
                            "Voice",
                            "Video",
                            "AddOn"
                        ],
                        "description": "The category of the product"
                    },
                    "productName": {
                        "type": "string",
                        "description": "The commercial name of the product (e.g., 'Fiber Internet 1 Gig')"
                    },
                    "monthlyPrice": {
                        "$ref": "#/components/schemas/Price"
                    },
                    "oneTimePrice": {
                        "$ref": "#/components/schemas/Price"
                    }
                },
                "required": [
                    "orgId",
                    "itemId",
                    "productType",
                    "productName"
                ]
            },
            "AddedToCartEvent": {
                "type": "object",
                "description": "Event fired when a customer adds items to their shopping cart",
                "properties": {
                    "eventId": {
                        "type": "string",
                        "format": "uuid",
                        "description": "Unique identifier for this event (for idempotency)"
                    },
                    "eventType": {
                        "type": "string",
                        "enum": [
                            "ADDED_TO_CART"
                        ],
                        "default": "ADDED_TO_CART",
                        "description": "Type of event"
                    },
                    "eventTimestamp": {
                        "type": "string",
                        "format": "date-time",
                        "description": "Timestamp when this event occurred"
                    },
                    "orgId": {
                        "type": "string",
                        "description": "Identifier of the organization/tenant"
                    },
                    "cartId": {
                        "type": "string",
                        "format": "uuid",
                        "description": "Unique identifier for the shopping cart"
                    },
                    "cartStatus": {
                        "type": "string",
                        "enum": [
                            "Active",
                            "Abandoned",
                            "Converted"
                        ],
                        "default": "Active",
                        "description": "Current status of the cart"
                    },
                    "customerId": {
                        "type": "string",
                        "description": "Identifier of the customer (if known/logged in)"
                    },
                    "sessionId": {
                        "type": "string",
                        "description": "Browser/session identifier for anonymous users"
                    },
                    "CustomerDetails": {
                        "$ref": "../../reusableComponents/swagger.json#/components/schemas/CustomerDetails"
                    },
                    "lineItems": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/OrderLineItem"
                        },
                        "description": "Items currently in the cart"
                    },
                    "totalMonthlyPrice": {
                        "$ref": "#/components/schemas/Price"
                    },
                    "totalOneTimePrice": {
                        "$ref": "#/components/schemas/Price"
                    },
                    "cartCreatedAt": {
                        "type": "string",
                        "format": "date-time",
                        "description": "When the cart was originally created"
                    },
                    "lastModifiedAt": {
                        "type": "string",
                        "format": "date-time",
                        "description": "When the cart was last updated"
                    }
                },
                "required": [
                    "eventId",
                    "eventType",
                    "eventTimestamp",
                    "orgId",
                    "cartId",
                    "cartStatus",
                    "lineItems",
                    "cartCreatedAt",
                    "lastModifiedAt"
                ]
            }
        }
    },
    "paths": {
        "/events/added-to-cart": {
            "post": {
                "summary": "Added to Cart Event",
                "description": "Publishes a cart addition event to Kafka topic: cart.added",
                "tags": [
                    "Cart Events"
                ],
                "intent": "Cart Management",
                "sub_intent": "Add Item to Cart",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/AddedToCartEvent"
                            },
                            "sample_event": {
                                "eventId": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                                "eventType": "ADDED_TO_CART",
                                "eventTimestamp": "2024-01-15T14:30:00Z",
                                "orgId": "ORG-001",
                                "cartId": "550e8400-e29b-41d4-a716-446655440000",
                                "cartStatus": "Active",
                                "customerId": "CUST-12345",
                                "sessionId": "SESSION-98765",
                                "CustomerDetails": {
                                    "id": "CUSTDET-001",
                                    "orgId": "ORG-001",
                                    "fullName": "Jane Smith",
                                    "email": "jane.smith@email.com",
                                    "mobileNumber": "+1-555-987-6543"
                                },
                                "lineItems": [
                                    {
                                        "orgId": "ORG-001",
                                        "itemId": "ITEM-001",
                                        "productType": "Data",
                                        "productName": "Fiber Internet 1 Gig",
                                        "monthlyPrice": {
                                            "orgId": "ORG-001",
                                            "amount": 79.99,
                                            "currency": "USD"
                                        },
                                        "oneTimePrice": {
                                            "orgId": "ORG-001",
                                            "amount": 99.99,
                                            "currency": "USD"
                                        }
                                    }
                                ],
                                "totalMonthlyPrice": {
                                    "orgId": "ORG-001",
                                    "amount": 79.99,
                                    "currency": "USD"
                                },
                                "totalOneTimePrice": {
                                    "orgId": "ORG-001",
                                    "amount": 99.99,
                                    "currency": "USD"
                                },
                                "cartCreatedAt": "2024-01-15T14:25:00Z",
                                "lastModifiedAt": "2024-01-15T14:30:00Z"
                            }
                        }
                    }
                },
                "responses": {
                    "202": {
                        "description": "Event accepted for processing"
                    }
                }
            }
        }
    },
    "tags": [
        {
            "name": "Cart Events",
            "description": "Events related to cart lifecycle management"
        }
    ]
}